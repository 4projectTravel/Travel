{% extends 'map_base.html' %}

{% block title %}æœ­å¹Œã®ã‚¹ãƒãƒƒãƒˆã‚’æ¢ã™{% endblock %}
{% block h1 %}æœ­å¹Œã®ã‚¹ãƒãƒƒãƒˆã‚’æ¢ã™{% endblock %}


{% block extrajs %}
    <script>
    function formSwitch() {
     hoge = document.getElementsByName('pattern')

     if (hoge[0].checked) {
         // ãƒ©ãƒ³ã‚­ãƒ³ã‚°ã‚’è¡¨ç¤ºã™ã‚‹ãŒé¸æŠã•ã‚ŒãŸã‚‰ä¸‹è¨˜ã‚’å®Ÿè¡Œã—ã¾ã™
         document.getElementById('rankingList').style.display = "";
         //document.getElementById('rankingList').style.display = "none";
         document.getElementById('categoryList').style.display = "none";
         var inputItem = document.getElementById("rankingList").getElementsByTagName("input");
         for(var i=0; i<inputItem.length; i++){
         inputItem[i].checked = "";
         }
     } else if (hoge[1].checked) {
         // ã‚«ãƒ†ã‚´ãƒªãƒ¼ã”ã¨ã«è¡¨ç¤ºã™ã‚‹ãŒé¸æŠã•ã‚ŒãŸã‚‰ä¸‹è¨˜ã‚’å®Ÿè¡Œã—ã¾ã™
         document.getElementById('rankingList').style.display = "none";
         var inputItem = document.getElementById("categoryList").getElementsByTagName("input");
         for(var i=0; i<inputItem.length; i++){
         inputItem[i].checked = "";
         }
         document.getElementById('categoryList').style.display = "";
     } else {
         document.getElementById('rankingList').style.display = "none";
         //var inputItem = document.getElementById("rankingList").getElementsByTagName("input");
         //for(var i=0; i<selectItem.length; i++){
         //inputItem[i].value = "";
         //}
         document.getElementById('categoryList').style.display = "none";
         //var inputItem = document.getElementById("categoryList").getElementsByTagName("input");
         //for(var i=0; i<inputItem.length; i++){
             //inputItem[i].checked = "";
         //}
      }
    }
    window.addEventListener('load', formSwitch());

    /*æ¤œç´¢ãƒ•ã‚©ãƒ¼ãƒ */
    //ã€Œå…¨ã¦é¸æŠã€ã®ãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹
    let checkAll = document.getElementById("checkAll");
    //ã€Œå…¨ã¦é¸æŠã€ä»¥å¤–ã®ãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹
    let el = document.getElementsByClassName("checks");

    //å…¨ã¦ã®ãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹ã‚’ON/OFFã™ã‚‹
    const funcCheckAll = (bool) => {
      for (let i = 0; i < el.length; i++) {
          el[i].checked = bool;
      }
    }

    //ã€Œchecksã€ã®classã‚’æŒã¤è¦ç´ ã®ãƒã‚§ãƒƒã‚¯çŠ¶æ…‹ã§ã€Œå…¨ã¦é¸æŠã€ã®ãƒã‚§ãƒƒã‚¯çŠ¶æ…‹ã‚’ON/OFFã™ã‚‹
    const funcCheck = () => {
      let count = 0;
      for (let i = 0; i < el.length; i++) {
           if (el[i].checked) {
                count += 1;
           }
       }

       if (el.length === count) {
           checkAll.checked = true;
      } else {
         checkAll.checked = false;
      }
    };

    //ã€Œå…¨ã¦é¸æŠã€ã®ãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ãŸæ™‚
    checkAll.addEventListener("click",() => {
         funcCheckAll(checkAll.checked);
    },false);

    //ã€Œå…¨ã¦é¸æŠã€ä»¥å¤–ã®ãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ãŸæ™‚
    for (let i = 0; i < el.length; i++) {
         el[i].addEventListener("click", funcCheck, false);
    }
    </script>


    <!--<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mdb-ui-kit/4.0.0/mdb.min.js">-->
    <script>


      var arr;
      var chk1;
      var top20;
      var tableEle;


      function clickBtn1() {
        chk1 = document.getElementsByName("chk1");
        top20 = document.getElementsByName("top20");
        //document.getElementById("span1").textContent = arr;

        var xhttp = new XMLHttpRequest();
          xhttp.onreadystatechange = function() {
               if (this.readyState == 4 && this.status == 200) {
                  setMarker(JSON.parse(this.responseText));
                  setTable(JSON.parse(this.responseText));
               }
          };
          xhttp.open("GET", "api/map?format=json", true);
          xhttp.setRequestHeader("Content-type", "application/json");
          xhttp.send();
       }


      var map;
      var marker;
      var circle;


      /**
       * The CenterControl adds a control to the map that recenters the map on
       * Chicago.
       * This constructor takes the control DIV as an argument.
       * @constructor
       */


      function CenterControl(controlDiv, map) {

        // Set CSS for the control border.

        var controlUI = document.createElement('div');
        controlUI.style.backgroundColor = '#fff';
        controlUI.style.border = '2px solid #fff';
        controlUI.style.borderRadius = '3px';
        controlUI.style.boxShadow = '0 2px 6px rgba(0,0,0,.3)';
        controlUI.style.cursor = 'pointer';
        controlUI.style.marginBottom = '22px';
        controlUI.style.textAlign = 'center';
        controlUI.title = 'Click to recenter the map';
        controlDiv.appendChild(controlUI);
      }

      var currentPos;// ç·¯åº¦ãƒ»çµŒåº¦
      var directionsService;
      var directionsRenderer;

      function initMap() {
        map = new google.maps.Map(document.getElementById('map'), {
          /*center: {lat: 35.681236, lng: 139.767125},*/
           center: {lat: 35.323791, lng: 139.54749},
          zoom: 9

        });

        var centerControlDiv = document.createElement('div');
        var centerControl = new CenterControl(centerControlDiv, map);

        centerControlDiv.index = 1;
        map.controls[google.maps.ControlPosition.TOP_CENTER].push(centerControlDiv);

        /*ä½ç½®æƒ…å ±ã‚’è¡¨ç¤ºã™ã‚‹*/

              function success(pos) {
                 var crd = pos.coords;



        ã€€ã€€ã€€ã€€ã€€/*ç¾åœ¨åœ°*/
                 //currentPos = new google.maps.LatLng( crd.latitude, crd.longitude);// ç·¯åº¦ãƒ»çµŒåº¦
                 currentPos = new google.maps.LatLng(43.062024, 141.35444);
                 directionsService = new google.maps.DirectionsService();
                 directionsRenderer = new google.maps.DirectionsRenderer();

                 if ( marker != undefined )  marker.setMap(null);
                 if ( circle != undefined )  circle.setMap(null);

                 /* ç¾åœ¨ä½ç½®ã«ãƒãƒ¼ã‚«ãƒ¼ã‚’è¨­å®š */
                 marker = new google.maps.Marker({
                    position: currentPos, //ãƒãƒ¼ã‚«ãƒ¼ã®ä½ç½®ï¼ˆå¿…é ˆï¼‰
        			      map: map //ãƒãƒ¼ã‚«ãƒ¼ã‚’è¡¨ç¤ºã™ã‚‹åœ°å›³
                  });


                 var center_now = {lat: 43.062024, lng: 141.35444};

                 map.setCenter(center_now);
                 map.setZoom(10);
                 //setInfo(crd);

                 /*éŒå€‰å¸‚ã‚’ä¸­å¿ƒã«å††ã‚’è¡¨ç¤ºã™ã‚‹*/
                 var myCircle_330 = new google.maps.Circle({
                   strokeColor: '#028760',
                   strokeOpacity: 0.8,
                   strokeWeight: 2,
                   fillColor: '#028760',
                   fillOpacity: 0.35,
                   map: map,
                   center: currentPos,
                   //center: {lat: 35.323791, lng: 139.54749},
                   radius: 330  //åŠå¾„1000ãƒ¡ãƒ¼ãƒˆãƒ«
                 });

                 var myCircle_1000 = new google.maps.Circle({
                   strokeColor: '#FF0000',
                   strokeOpacity: 0.8,
                   strokeWeight: 2,
                   fillColor: '#FF0000',
                   fillOpacity: 0.35,
                   map: map,
                   //center: {lat: 35.323791, lng: 139.54749},
                   center: currentPos,
                   radius: 1000  //åŠå¾„1000ãƒ¡ãƒ¼ãƒˆãƒ«
                 });

                 var myCircle_2000 = new google.maps.Circle({
                   strokeColor: '#0095d9',
                   strokeOpacity: 0.8,
                   strokeWeight: 2,
                   fillColor: '#0095d9',
                   fillOpacity: 0.35,
                   map: map,
                   //center: {lat: 35.323791, lng: 139.54749},
                   center: currentPos,
                   radius: 2000  //åŠå¾„2000ãƒ¡ãƒ¼ãƒˆãƒ«
                 });

              }

              navigator.geolocation.getCurrentPosition(success);
      }

      function setMarker(mapJson) {

      /*ã‚¸ãƒ£ãƒ³ãƒ«ã”ã¨ã«è¡¨ç¤º*/
        var count = 0;
        var count2 = 0;
        for(var j = 0; j < chk1.length-1; j++){
          if(chk1[j].checked == true){
            count++;
          }
        }

        if(count == 1 || count == 2 || count == 5){
          var eachnumber = 10 / count;
        }else if(count == 3 || count == 4 || count == 6){
          var eachnumber = 12 / count;
        }else{
          var eachnumber = 14 / count;
        }

        for(var j = 0; j < chk1.length; j++){
          for(var i=0; i < mapJson.length; i++){

            if(count2 == eachnumber){
              count2 = 0;
              break;
            }

            if(mapJson[i].area_number == 2){


            if(chk1[j].checked==true && chk1[j].value==mapJson[i].genre){
              var contentStr = '<p>'+mapJson[i].name+ '<br>' + mapJson[i].address+'</p>';
              var infowindow = new google.maps.InfoWindow({
                content: contentStr
              });


              if(mapJson[i].genre == 'ã”ã¯ã‚“'){
                var marker = new google.maps.Marker({
                  position: {lat: Number(mapJson[i].lat), lng: Number(mapJson[i].lng)},
                  map: map,
                  icon: {
                    fillColor: "#ffdc00",//å¡—ã‚Šæ½°ã—è‰²
                    scale: 10,
                    fillOpacity: 0.8,
                    strokeWeight: 1.0,
                    path: google.maps.SymbolPath.CIRCLE, //å††ã‚’æŒ‡å®š
                 },
                  label: {
                   text: mapJson[i].number,                           //ãƒ©ãƒ™ãƒ«æ–‡å­—
                    color: '#000000',                    //æ–‡å­—ã®è‰²
                    fontSize: '15px'                     //æ–‡å­—ã®ã‚µã‚¤ã‚º
                   }
                });

              }else if(mapJson[i].genre == 'åæ‰€ãƒ»æ—§è·¡'){
                var marker = new google.maps.Marker({
                  position: {lat: Number(mapJson[i].lat), lng: Number(mapJson[i].lng)},
                  map: map,
                  icon: {
                    fillColor: "#3333FF",//å¡—ã‚Šæ½°ã—è‰²
                    scale: 10,
                    fillOpacity: 0.8,
                     strokeWeight: 1.0,
                     path: google.maps.SymbolPath.CIRCLE, //å††ã‚’æŒ‡å®š
                 },
                 label: {
                  text: mapJson[i].number,                           //ãƒ©ãƒ™ãƒ«æ–‡å­—
                  color: '#000000',                    //æ–‡å­—ã®è‰²
                  fontSize: '15px'                     //æ–‡å­—ã®ã‚µã‚¤ã‚º
                 }
                });
              }else if(mapJson[i].genre == 'ã‚«ãƒ•ã‚§ãƒ»ãƒ‘ãƒ³ãƒ»ã‚¹ã‚¤ãƒ¼ãƒ„ãƒ»ãŠè“å­'){
                var marker = new google.maps.Marker({
                  position: {lat: Number(mapJson[i].lat), lng: Number(mapJson[i].lng)},
                  map: map,
                  icon: {
                    fillColor: "#ff0000",//å¡—ã‚Šæ½°ã—è‰²
                    scale: 10,
                    fillOpacity: 0.8,
                     strokeWeight: 1.0,
                     path: google.maps.SymbolPath.CIRCLE, //å††ã‚’æŒ‡å®š
                 },
                 label: {
                  text: mapJson[i].number,                           //ãƒ©ãƒ™ãƒ«æ–‡å­—
                  color: '#000000',                    //æ–‡å­—ã®è‰²
                  fontSize: '15px'                     //æ–‡å­—ã®ã‚µã‚¤ã‚º
                 }
                });
              }else if(mapJson[i].genre == 'é¢¨æ™¯ãƒ»æ™¯è‰²'){
                var marker = new google.maps.Marker({
                  position: {lat: Number(mapJson[i].lat), lng: Number(mapJson[i].lng)},
                  map: map,
                  icon: {
                    fillColor: "#ee7800",//å¡—ã‚Šæ½°ã—è‰²
                    scale: 10,
                    fillOpacity: 0.8,
                     strokeWeight: 1.0,
                     path: google.maps.SymbolPath.CIRCLE, //å††ã‚’æŒ‡å®š
                 },
                 label: {
                  text: mapJson[i].number,                           //ãƒ©ãƒ™ãƒ«æ–‡å­—
                  color: '#000000',                    //æ–‡å­—ã®è‰²
                  fontSize: '15px'                     //æ–‡å­—ã®ã‚µã‚¤ã‚º
                 }
                });
              }else if(mapJson[i].genre == 'ã‚¢ãƒ¼ãƒˆãƒ»ã‚«ãƒ«ãƒãƒ£ãƒ¼'){
                var marker = new google.maps.Marker({
                  position: {lat: Number(mapJson[i].lat), lng: Number(mapJson[i].lng)},
                  map: map,
                  icon: {
                    fillColor: "#ffa0ed",//å¡—ã‚Šæ½°ã—è‰²
                    scale: 10,
                    fillOpacity: 0.8,
                     strokeWeight: 1.0,
                     path: google.maps.SymbolPath.CIRCLE, //å††ã‚’æŒ‡å®š
                 },
                 label: {
                  text: mapJson[i].number,                           //ãƒ©ãƒ™ãƒ«æ–‡å­—
                  color: '#000000',                    //æ–‡å­—ã®è‰²
                  fontSize: '15px'                     //æ–‡å­—ã®ã‚µã‚¤ã‚º
                 }
                });
              }else if(mapJson[i].genre == 'ãŠåœŸç”£ãƒ»ãŠé…’ãƒ»é›‘è²¨'){
                var marker = new google.maps.Marker({
                  position: {lat: Number(mapJson[i].lat), lng: Number(mapJson[i].lng)},
                  map: map,
                  icon: {
                    fillColor: "#a260bf",//å¡—ã‚Šæ½°ã—è‰²
                    scale: 10,
                    fillOpacity: 0.8,
                     strokeWeight: 1.0,
                     path: google.maps.SymbolPath.CIRCLE, //å††ã‚’æŒ‡å®š
                 },
                 label: {
                  text: mapJson[i].number,                           //ãƒ©ãƒ™ãƒ«æ–‡å­—
                  color: '#000000',                    //æ–‡å­—ã®è‰²
                  fontSize: '15px'                     //æ–‡å­—ã®ã‚µã‚¤ã‚º
                 }
                });
              }else if(mapJson[i].genre == 'ã‚¢ã‚¯ãƒ†ã‚£ãƒ“ãƒ†ã‚£ãƒ»ä½“é¨“ãƒ»ãã®ä»–æ–½è¨­'){
                var marker = new google.maps.Marker({
                  position: {lat: Number(mapJson[i].lat), lng: Number(mapJson[i].lng)},
                  map: map,
                  icon: {
                    fillColor: "#008000",//å¡—ã‚Šæ½°ã—è‰²
                    scale: 10,
                    fillOpacity: 0.8,
                     strokeWeight: 1.0,
                     path: google.maps.SymbolPath.CIRCLE, //å††ã‚’æŒ‡å®š
                 },
                 label: {
                  text: mapJson[i].number,                           //ãƒ©ãƒ™ãƒ«æ–‡å­—
                  color: '#000000',                    //æ–‡å­—ã®è‰²
                  fontSize: '15px'                     //æ–‡å­—ã®ã‚µã‚¤ã‚º
                 }
                });
              }
              count2++;
              bindInfoWindow(marker, map, infowindow);
            }
           }
          }
        }
        /*ãƒˆãƒƒãƒ—20è¡¨ç¤º*/
        for(var j = 0; j < chk1.length; j++){
          for(var i=71; i < 100; i++){
            for(var m=0; m < top20.length; m++){
            if(top20[m].checked==true){
              var contentStr = '<p>'+mapJson[i].name + '<br>' + mapJson[i].address+'</p>';

              var infowindow = new google.maps.InfoWindow({
                content: contentStr
              });

              if(mapJson[i].genre == 'ã”ã¯ã‚“'){
                var marker = new google.maps.Marker({
                  position: {lat: Number(mapJson[i].lat), lng: Number(mapJson[i].lng)},
                  map: map,
                  icon: {
                    fillColor: "#ffdc00",//å¡—ã‚Šæ½°ã—è‰²
                    scale: 10,
                    fillOpacity: 0.8,
                    strokeWeight: 1.0,
                    path: google.maps.SymbolPath.CIRCLE, //å††ã‚’æŒ‡å®š
                 },
                  label: {
                   text: mapJson[i].number,                           //ãƒ©ãƒ™ãƒ«æ–‡å­—
                    color: '#000000',                    //æ–‡å­—ã®è‰²
                    fontSize: '15px'                     //æ–‡å­—ã®ã‚µã‚¤ã‚º
                   }
                });

              }else if(mapJson[i].genre == 'åæ‰€ãƒ»æ—§è·¡'){
                var marker = new google.maps.Marker({
                  position: {lat: Number(mapJson[i].lat), lng: Number(mapJson[i].lng)},
                  map: map,
                  icon: {
                    fillColor: "#3333FF",//å¡—ã‚Šæ½°ã—è‰²
                    scale: 10,
                    fillOpacity: 0.8,
                     strokeWeight: 1.0,
                     path: google.maps.SymbolPath.CIRCLE, //å††ã‚’æŒ‡å®š
                 },
                 label: {
                  text: mapJson[i].number,                           //ãƒ©ãƒ™ãƒ«æ–‡å­—
                  color: '#000000',                    //æ–‡å­—ã®è‰²
                  fontSize: '15px'                     //æ–‡å­—ã®ã‚µã‚¤ã‚º
                 }
                });
              }else if(mapJson[i].genre == 'ã‚«ãƒ•ã‚§ãƒ»ãƒ‘ãƒ³ãƒ»ã‚¹ã‚¤ãƒ¼ãƒ„ãƒ»ãŠè“å­'){
                var marker = new google.maps.Marker({
                  position: {lat: Number(mapJson[i].lat), lng: Number(mapJson[i].lng)},
                  map: map,
                  icon: {
                    fillColor: "#ff0000",//å¡—ã‚Šæ½°ã—è‰²
                    scale: 10,
                    fillOpacity: 0.8,
                     strokeWeight: 1.0,
                     path: google.maps.SymbolPath.CIRCLE, //å††ã‚’æŒ‡å®š
                 },
                 label: {
                  text: mapJson[i].number,                           //ãƒ©ãƒ™ãƒ«æ–‡å­—
                  color: '#000000',                    //æ–‡å­—ã®è‰²
                  fontSize: '15px'                     //æ–‡å­—ã®ã‚µã‚¤ã‚º
                 }
                });
              }else if(mapJson[i].genre == 'é¢¨æ™¯ãƒ»æ™¯è‰²'){
                var marker = new google.maps.Marker({
                  position: {lat: Number(mapJson[i].lat), lng: Number(mapJson[i].lng)},
                  map: map,
                  icon: {
                    fillColor: "#ee7800",//å¡—ã‚Šæ½°ã—è‰²
                    scale: 10,
                    fillOpacity: 0.8,
                     strokeWeight: 1.0,
                     path: google.maps.SymbolPath.CIRCLE, //å††ã‚’æŒ‡å®š
                 },
                 label: {
                  text: mapJson[i].number,                           //ãƒ©ãƒ™ãƒ«æ–‡å­—
                  color: '#000000',                    //æ–‡å­—ã®è‰²
                  fontSize: '15px'                     //æ–‡å­—ã®ã‚µã‚¤ã‚º
                 }
                });
              }else if(mapJson[i].genre == 'ã‚¢ãƒ¼ãƒˆãƒ»ã‚«ãƒ«ãƒãƒ£ãƒ¼'){
                var marker = new google.maps.Marker({
                  position: {lat: Number(mapJson[i].lat), lng: Number(mapJson[i].lng)},
                  map: map,
                  icon: {
                    fillColor: "#ffa0ed",//å¡—ã‚Šæ½°ã—è‰²
                    scale: 10,
                    fillOpacity: 0.8,
                     strokeWeight: 1.0,
                     path: google.maps.SymbolPath.CIRCLE, //å††ã‚’æŒ‡å®š
                 },
                 label: {
                  text: mapJson[i].number,                           //ãƒ©ãƒ™ãƒ«æ–‡å­—
                  color: '#000000',                    //æ–‡å­—ã®è‰²
                  fontSize: '15px'                     //æ–‡å­—ã®ã‚µã‚¤ã‚º
                 }
                });
              }else if(mapJson[i].genre == 'ãŠåœŸç”£ãƒ»ãŠé…’ãƒ»é›‘è²¨'){
                var marker = new google.maps.Marker({
                  position: {lat: Number(mapJson[i].lat), lng: Number(mapJson[i].lng)},
                  map: map,
                  icon: {
                    fillColor: "#a260bf",//å¡—ã‚Šæ½°ã—è‰²
                    scale: 10,
                    fillOpacity: 0.8,
                     strokeWeight: 1.0,
                     path: google.maps.SymbolPath.CIRCLE, //å††ã‚’æŒ‡å®š
                 },
                 label: {
                  text: mapJson[i].number,                           //ãƒ©ãƒ™ãƒ«æ–‡å­—
                  color: '#000000',                    //æ–‡å­—ã®è‰²
                  fontSize: '15px'                     //æ–‡å­—ã®ã‚µã‚¤ã‚º
                 }
                });
              }else if(mapJson[i].genre == 'ã‚¢ã‚¯ãƒ†ã‚£ãƒ“ãƒ†ã‚£ãƒ»ä½“é¨“ãƒ»ãã®ä»–æ–½è¨­'){
                var marker = new google.maps.Marker({
                  position: {lat: Number(mapJson[i].lat), lng: Number(mapJson[i].lng)},
                  map: map,
                  icon: {
                    fillColor: "#008000",//å¡—ã‚Šæ½°ã—è‰²
                    scale: 10,
                    fillOpacity: 0.8,
                     strokeWeight: 1.0,
                     path: google.maps.SymbolPath.CIRCLE, //å††ã‚’æŒ‡å®š
                 },
                 label: {
                  text: mapJson[i].number,                           //ãƒ©ãƒ™ãƒ«æ–‡å­—
                  color: '#000000',                    //æ–‡å­—ã®è‰²
                  fontSize: '15px'                     //æ–‡å­—ã®ã‚µã‚¤ã‚º
                 }
                });
              }

              bindInfoWindow(marker, map, infowindow);
            }
          }
          }
        }
      }


      function setTable(mapJson){

        /*top20ä¸€è¦§è¡¨ç¤º*/
        var tableEle = document.getElementById('data-table');
         for(var i = 71; i<  100; i++){
             for(var m=0; m < top20.length; m++){
             if(top20[m].checked==true){

               if(mapJson[i].name == "ç™½ã„æ‹äººãƒ‘ãƒ¼ã‚¯"){

                 (function (i) {
                   var origin = currentPos; // å‡ºç™ºåœ°ã®ç·¯åº¦ã¨çµŒåº¦
                   //å‡ºç™ºåœ°ã‚’éŒå€‰ã«å¤‰æ›´
                   //var origin = new google.maps.LatLng( 35.3188764, 139.551976);
                   var destination = new google.maps.LatLng(mapJson[i].lat, mapJson[i].lng); // ç›®çš„åœ°ã®ç·¯åº¦ã¨çµŒåº¦

                   var requestwalking = {
                     origin: origin,
                     destination: destination,
                     travelMode: google.maps.TravelMode.WALKING
                   };

                   var requestdriving = {
                     origin: origin,
                     destination: destination,
                     travelMode: google.maps.TravelMode.DRIVING
                   };

                   var tr = document.createElement('tr');
                   var td1 = document.createElement('td');
                   var td2 = document.createElement('td');
                   var td3 = document.createElement('td');
                   var td5 = document.createElement('td');
                   var td6 = document.createElement('td');
                   var td7 = document.createElement('td');

                   /*è©³ç´°ãƒšãƒ¼ã‚¸ã«é£›ã¶ãƒªãƒ³ã‚¯(1,6,13)*/

                   /*ã“ã“ã¾ã§*/
                   var text1 = '<a href="{% url 'detail-post' 55 %}">'
                   var text2 = '</a>'
                   td1.innerHTML = mapJson[i].number+'. '+text1 + mapJson[i].name + text2;
                   td2.innerHTML = text1 + mapJson[i].name + text2;
                   td3.innerHTML = mapJson[i].genre+','+mapJson[i+1].genre+','+mapJson[i+2].genre+','+mapJson[i+3].genre;
                   td7.innerHTML = '<img src="/media/NO.2.png" style="width:30px;height:30px">';

                   directionsService.route(requestwalking, function (response, status){
                     if(status == 'OK'){
                       var route = response.routes[0];
                       var routeLeg = route.legs[0];
                       var durationText = routeLeg.duration.text;

                       if(route.legs[0].duration.value <= 300){
                         td5.innerHTML = 'ğŸƒâ€â™€ï¸' + durationText;
                         td5.style.color = '#028760';
                         //td4.style.border = '1px solid black';
                       }else if(route.legs[0].duration.value <= 900){
                         td5.innerHTML = 'ğŸƒâ€â™€ï¸' + durationText;
                         td5.style.color = '#FF0000';
                         //td4.style.border = '1px solid black';
                       }else if(route.legs[0].duration.value <= 1800){
                         td5.innerHTML = 'ğŸƒâ€â™€ï¸' + durationText;
                         td5.style.color = '#0095d9';
                         //td4.style.border = '1px solid black';
                       }else{
                         td5.innerHTML = 'ğŸƒâ€â™€ï¸' + durationText;
                       }
                     }
                   });

                   directionsService.route(requestdriving, function (response, status){
                     if(status == 'OK'){
                       var route = response.routes[0];
                       var routeLeg = route.legs[0];
                       var durationText = routeLeg.duration.text;

                       td6.innerHTML = 'ğŸš˜' + durationText;
                     }
                   });


                   tr.appendChild(td7);
                   tr.appendChild(td1);
                   tr.appendChild(td3);
                   tr.appendChild(td5);
                   tr.appendChild(td6);
                   tableEle.appendChild(tr);
                 })(i);
                 i=i+3;

               }else if(mapJson[i].name == "JRã‚¿ãƒ¯ãƒ¼" || mapJson[i].name == "ã•ã£ã½ã‚ãƒ†ãƒ¬ãƒ“å¡”"){

                   (function (i) {
                     var origin = currentPos; // å‡ºç™ºåœ°ã®ç·¯åº¦ã¨çµŒåº¦
                     //å‡ºç™ºåœ°ã‚’éŒå€‰ã«å¤‰æ›´
                     //var origin = new google.maps.LatLng( 35.3188764, 139.551976);
                     var destination = new google.maps.LatLng(mapJson[i].lat, mapJson[i].lng); // ç›®çš„åœ°ã®ç·¯åº¦ã¨çµŒåº¦

                     var requestwalking = {
                       origin: origin,
                       destination: destination,
                       travelMode: google.maps.TravelMode.WALKING
                     };

                     var requestdriving = {
                       origin: origin,
                       destination: destination,
                       travelMode: google.maps.TravelMode.DRIVING
                     };

                     var tr = document.createElement('tr');
                     var td1 = document.createElement('td');
                     var td2 = document.createElement('td');
                     var td3 = document.createElement('td');
                     var td5 = document.createElement('td');
                     var td6 = document.createElement('td');
                     var td7 = document.createElement('td');

                     /*è©³ç´°ãƒšãƒ¼ã‚¸ã«é£›ã¶ãƒªãƒ³ã‚¯(1,6,13)*/

                     /*ã“ã“ã¾ã§*/
                     var text1 = '<a href="{% url 'detail-post' 55 %}">'
                     var text2 = '</a>'
                     td1.innerHTML = mapJson[i].number+'. '+text1 + mapJson[i].name + text2;
                     td2.innerHTML = text1 + mapJson[i].name + text2;
                     td3.innerHTML = mapJson[i].genre+','+mapJson[i+1].genre+','+mapJson[i+2].genre;
                     td7.innerHTML = '<font size="1">'+'No.'+ mapJson[i].number + '</font>';

                     directionsService.route(requestwalking, function (response, status){
                       if(status == 'OK'){
                         var route = response.routes[0];
                         var routeLeg = route.legs[0];
                         var durationText = routeLeg.duration.text;

                         if(route.legs[0].duration.value <= 300){
                           td5.innerHTML = 'ğŸƒâ€â™€ï¸' + durationText;
                           td5.style.color = '#028760';
                           //td4.style.border = '1px solid black';
                         }else if(route.legs[0].duration.value <= 900){
                           td5.innerHTML = 'ğŸƒâ€â™€ï¸' + durationText;
                           td5.style.color = '#FF0000';
                           //td4.style.border = '1px solid black';
                         }else if(route.legs[0].duration.value <= 1800){
                           td5.innerHTML = 'ğŸƒâ€â™€ï¸' + durationText;
                           td5.style.color = '#0095d9';
                           //td4.style.border = '1px solid black';
                         }else{
                           td5.innerHTML = 'ğŸƒâ€â™€ï¸' + durationText;
                         }
                       }
                     });

                     directionsService.route(requestdriving, function (response, status){
                       if(status == 'OK'){
                         var route = response.routes[0];
                         var routeLeg = route.legs[0];
                         var durationText = routeLeg.duration.text;

                         td6.innerHTML = 'ğŸš˜' + durationText;
                       }
                     });

                     tr.appendChild(td7);
                     tr.appendChild(td1);
                     tr.appendChild(td3);
                     tr.appendChild(td5);
                     tr.appendChild(td6);
                     tableEle.appendChild(tr);
                   })(i);
                   i=i+2;
             }else if(mapJson[i].name == mapJson[i+1].name){

               (function (i) {
                 var origin = currentPos; // å‡ºç™ºåœ°ã®ç·¯åº¦ã¨çµŒåº¦
                 //å‡ºç™ºåœ°ã‚’éŒå€‰ã«å¤‰æ›´
                 //var origin = new google.maps.LatLng( 35.3188764, 139.551976);
                 var destination = new google.maps.LatLng(mapJson[i].lat, mapJson[i].lng); // ç›®çš„åœ°ã®ç·¯åº¦ã¨çµŒåº¦

                 var requestwalking = {
                   origin: origin,
                   destination: destination,
                   travelMode: google.maps.TravelMode.WALKING
                 };

                 var requestdriving = {
                   origin: origin,
                   destination: destination,
                   travelMode: google.maps.TravelMode.DRIVING
                 };

                 var tr = document.createElement('tr');
                 var td1 = document.createElement('td');
                 var td2 = document.createElement('td');
                 var td3 = document.createElement('td');
                 var td5 = document.createElement('td');
                 var td6 = document.createElement('td');
                 var td7 = document.createElement('td');

                 /*è©³ç´°ãƒšãƒ¼ã‚¸ã«é£›ã¶ãƒªãƒ³ã‚¯(1,6,13)*/
                var text1 = '<a href="{% url 'detail-post' 55 %}">'

                 /*ã“ã“ã¾ã§*/

                 var text2 = '</a>'
                 td1.innerHTML = mapJson[i].number+'. '+text1 + mapJson[i].name + text2;
                 td2.innerHTML = text1 + mapJson[i].name + text2;
                 td3.innerHTML = mapJson[i].genre+'   ,   '+mapJson[i+1].genre;
                 td7.innerHTML = '<font size="1">'+'No.'+ mapJson[i].number + '</font>';

                 directionsService.route(requestwalking, function (response, status){
                   if(status == 'OK'){
                     var route = response.routes[0];
                     var routeLeg = route.legs[0];
                     var durationText = routeLeg.duration.text;

                     if(route.legs[0].duration.value <= 300){
                       td5.innerHTML = 'ğŸƒâ€â™€ï¸' + durationText;
                       td5.style.color = '#028760';
                       //td4.style.border = '1px solid black';
                     }else if(route.legs[0].duration.value <= 900){
                       td5.innerHTML = 'ğŸƒâ€â™€ï¸' + durationText;
                       td5.style.color = '#FF0000';
                       //td4.style.border = '1px solid black';
                     }else if(route.legs[0].duration.value <= 1800){
                       td5.innerHTML = 'ğŸƒâ€â™€ï¸' + durationText;
                       td5.style.color = '#0095d9';
                       //td4.style.border = '1px solid black';
                     }else{
                       td5.innerHTML = 'ğŸƒâ€â™€ï¸' + durationText;
                     }
                   }
                 });

                 directionsService.route(requestdriving, function (response, status){
                   if(status == 'OK'){
                     var route = response.routes[0];
                     var routeLeg = route.legs[0];
                     var durationText = routeLeg.duration.text;

                     td6.innerHTML = 'ğŸš˜' + durationText;
                   }
                 });

                 tr.appendChild(td7);
                 tr.appendChild(td1);
                 tr.appendChild(td3);
                 tr.appendChild(td5);
                 tr.appendChild(td6);
                 tableEle.appendChild(tr);
               })(i);
               i++;
             }else{

               (function (i) {
                 var origin = currentPos; // å‡ºç™ºåœ°ã®ç·¯åº¦ã¨çµŒåº¦
                 //å‡ºç™ºåœ°ã‚’éŒå€‰ã«å¤‰æ›´
                 //var origin = new google.maps.LatLng( 35.3188764, 139.551976);
                 var destination = new google.maps.LatLng(mapJson[i].lat, mapJson[i].lng); // ç›®çš„åœ°ã®ç·¯åº¦ã¨çµŒåº¦

                 var requestwalking = {
                   origin: origin,
                   destination: destination,
                   travelMode: google.maps.TravelMode.WALKING
                 };

                 var requestdriving = {
                   origin: origin,
                   destination: destination,
                   travelMode: google.maps.TravelMode.DRIVING
                 };

                 var tr = document.createElement('tr');
                 var td1 = document.createElement('td');
                 var td3 = document.createElement('td');
                 var td5 = document.createElement('td');
                 var td6 = document.createElement('td');
                 var td7 = document.createElement('td');

                 /*è©³ç´°ãƒšãƒ¼ã‚¸ã«é£›ã¶ãƒªãƒ³ã‚¯(1,6,13ä»¥å¤–,20ã¾ã§)*/

                 /*ã“ã“ã¾ã§*/
                 var text1 = '<a href="{% url 'detail-post' 1 %}">'
                 var text2 = '</a>'
                 td1.innerHTML = mapJson[i].number+'. '+text1 + mapJson[i].name + text2;
                 td3.innerHTML = mapJson[i].genre;
                 if(mapJson[i].name == "ã¯ã‚‹ã‚„"){
                   td7.innerHTML = '<img src="/media/NO.1.png" style="width:30px;height:30px">';
                 }else if(mapJson[i].name == "æ„›è·¯"){
                   td7.innerHTML = '<img src="/media/NO.3.png" style="width:30px;height:30px">';
                 }else{
                   td7.innerHTML = '<font size="1">'+'No.'+ã€€mapJson[i].number + '</font>';
                 }

                 directionsService.route(requestwalking, function (response, status){
                   if(status == 'OK'){
                     var route = response.routes[0];
                     var routeLeg = route.legs[0];
                     var durationText = routeLeg.duration.text;

                     if(route.legs[0].duration.value <= 300){
                       td5.innerHTML = 'ğŸƒâ€â™€ï¸' + durationText;
                       td5.style.color = '#028760';
                       //td4.style.border = '1px solid black';
                     }else if(route.legs[0].duration.value <= 900){
                       td5.innerHTML = 'ğŸƒâ€â™€ï¸' + durationText;
                       td5.style.color = '#FF0000';
                       //td4.style.border = '1px solid black';
                     }else if(route.legs[0].duration.value <= 1800){
                       td5.innerHTML = 'ğŸƒâ€â™€ï¸' + durationText;
                       td5style.color = '#0095d9';
                       //td4.style.border = '1px solid black';
                     }else{
                       td5.innerHTML = 'ğŸƒâ€â™€ï¸' + durationText;
                     }
                   }
                 });

                 directionsService.route(requestdriving, function (response, status){
                   if(status == 'OK'){
                     var route = response.routes[0];
                     var routeLeg = route.legs[0];
                     var durationText = routeLeg.duration.text;

                     td6.innerHTML = 'ğŸš˜' + durationText;
                   }
                 });

                 tr.appendChild(td7);
                 tr.appendChild(td1);
                 tr.appendChild(td3);
                 tr.appendChild(td5);
                 tr.appendChild(td6);
                 tableEle.appendChild(tr);
               })(i);

             }
           }
         }
       }
        /*ã‚¸ãƒ£ãƒ³ãƒ«åˆ¥ä¸€è¦§è¡¨ç¤º*/

        var tableEle = document.getElementById('data-table');
        var count = 0;
        var count2 = 0;
        for(var j = 0; j < chk1.length-1; j++){
          if(chk1[j].checked == true){
            count++;
          }
        }

        if(count == 1 || count == 2 || count == 5){
          var eachnumber = 10 / count;
        }else if(count == 3 || count == 4 || count == 6){
          var eachnumber = 12 / count;
        }else{
          var eachnumber = 14 / count;
        }

         for(var j = 0; j < chk1.length; j++){
           for (var i = 0; i< mapJson.length; i++){

             if(count2 == eachnumber){
               count2 = 0;
               break;
             }
             if(mapJson[i].area_number == 2){

             if(chk1[j].checked == true && chk1[j].value == mapJson[i].genre){

               (function (i) {
                 var origin = currentPos; // å‡ºç™ºåœ°ã®ç·¯åº¦ã¨çµŒåº¦
                 //å‡ºç™ºåœ°ã‚’éŒå€‰ã«å¤‰æ›´
                 //var origin = new google.maps.LatLng( 35.3188764, 139.551976);
                 var destination = new google.maps.LatLng(mapJson[i].lat, mapJson[i].lng); // ç›®çš„åœ°ã®ç·¯åº¦ã¨çµŒåº¦

                 var requestwalking = {
                   origin: origin,
                   destination: destination,
                   travelMode: google.maps.TravelMode.WALKING
                 };

                 var requestdriving = {
                   origin: origin,
                   destination: destination,
                   travelMode: google.maps.TravelMode.DRIVING
                 };

                 var tr = document.createElement('tr');
                 var td1 = document.createElement('td');
                 var td2 = document.createElement('td');
                 var td3 = document.createElement('td');
                 var td5 = document.createElement('td');
                 var td6 = document.createElement('td');

                 /*è©³ç´°ãƒšãƒ¼ã‚¸ã«é£›ã¶ãƒªãƒ³ã‚¯(1,6,13ä»¥å¤–,20ã¾ã§)*/
                 if(mapJson[i].number == 1){
                     var text1 = '<a href="{% url 'detail-post' 1 %}">'
                   }else if (mapJson[i].number == 2){
                     var text1 = '<a href="{% url 'detail-post' 2 %}">'
                   }else if (mapJson[i].number == 3){
                     var text1 = '<a href="{% url 'detail-post' 3 %}">'
                   }else if (mapJson[i].number == 4){
                     var text1 = '<a href="{% url 'detail-post' 4 %}">'
                   }else if (mapJson[i].number == 5){
                     var text1 = '<a href="{% url 'detail-post' 5 %}">'
                   }else if (mapJson[i].number == 6){
                     var text1 = '<a href="{% url 'detail-post' 6 %}">'
                   }else if (mapJson[i].number == 7){
                     var text1 = '<a href="{% url 'detail-post' 7 %}">'
                   }else if (mapJson[i].number == 8){
                     var text1 = '<a href="{% url 'detail-post' 8 %}">'
                   }else if (mapJson[i].number == 9){
                     var text1 = '<a href="{% url 'detail-post' 9 %}">'
                   }else if (mapJson[i].number == 10){
                     var text1 = '<a href="{% url 'detail-post' 10 %}">'
                   }else if (mapJson[i].number == 11){
                     var text1 = '<a href="{% url 'detail-post' 11 %}">'
                   }else if (mapJson[i].number == 12){
                     var text1 = '<a href="{% url 'detail-post' 12 %}">'
                   }else if (mapJson[i].number == 13){
                     var text1 = '<a href="{% url 'detail-post' 13 %}">'
                   }else if (mapJson[i].number == 14){
                     var text1 = '<a href="{% url 'detail-post' 14 %}">'
                   }else if (mapJson[i].number == 15){
                     var text1 = '<a href="{% url 'detail-post' 15 %}">'
                   }else if (mapJson[i].number == 16){
                     var text1 = '<a href="{% url 'detail-post' 16 %}">'
                   }else if (mapJson[i].number == 17){
                     var text1 = '<a href="{% url 'detail-post' 17 %}">'
                   }else if (mapJson[i].number == 18){
                     var text1 = '<a href="{% url 'detail-post' 18 %}">'
                   }else if (mapJson[i].number == 19){
                     var text1 = '<a href="{% url 'detail-post' 19 %}">'
                   }else if (mapJson[i].number == 20){
                     var text1 = '<a href="{% url 'detail-post' 20 %}">'
                   }else if (mapJson[i].number == 21){
                     var text1 = '<a href="{% url 'detail-post' 21 %}">'
                   }else if (mapJson[i].number == 22){
                     var text1 = '<a href="{% url 'detail-post' 22 %}">'
                   }else if (mapJson[i].number == 23){
                     var text1 = '<a href="{% url 'detail-post' 23 %}">'
                   }else if (mapJson[i].number == 24){
                     var text1 = '<a href="{% url 'detail-post' 24 %}">'
                   }else if (mapJson[i].number == 25){
                     var text1 = '<a href="{% url 'detail-post' 25 %}">'
                   }else if (mapJson[i].number == 26){
                     var text1 = '<a href="{% url 'detail-post' 26 %}">'
                   }else if (mapJson[i].number == 27){
                     var text1 = '<a href="{% url 'detail-post' 27 %}">'
                   }else if (mapJson[i].number == 28){
                     var text1 = '<a href="{% url 'detail-post' 28 %}">'
                   }else if (mapJson[i].number == 29){
                     var text1 = '<a href="{% url 'detail-post' 29 %}">'
                   }else if (mapJson[i].number == 30){
                     var text1 = '<a href="{% url 'detail-post' 30 %}">'
                   }else if (mapJson[i].number == 31){
                     var text1 = '<a href="{% url 'detail-post' 31 %}">'
                   }else if (mapJson[i].number == 32){
                     var text1 = '<a href="{% url 'detail-post' 32 %}">'
                   }else if (mapJson[i].number == 33){
                     var text1 = '<a href="{% url 'detail-post' 33 %}">'
                   }else if (mapJson[i].number == 34){
                     var text1 = '<a href="{% url 'detail-post' 34 %}">'
                   }else if (mapJson[i].number == 35){
                     var text1 = '<a href="{% url 'detail-post' 35 %}">'
                   }else if (mapJson[i].number == 36){
                     var text1 = '<a href="{% url 'detail-post' 36 %}">'
                   }else if (mapJson[i].number == 37){
                     var text1 = '<a href="{% url 'detail-post' 37 %}">'
                   }else if (mapJson[i].number == 38){
                     var text1 = '<a href="{% url 'detail-post' 38 %}">'
                   }else if (mapJson[i].number == 39){
                     var text1 = '<a href="{% url 'detail-post' 39 %}">'
                   }else if (mapJson[i].number == 40){
                     var text1 = '<a href="{% url 'detail-post' 40 %}">'
                   }else if (mapJson[i].number == 41){
                     var text1 = '<a href="{% url 'detail-post' 41 %}">'
                   }else if (mapJson[i].number == 42){
                     var text1 = '<a href="{% url 'detail-post' 42 %}">'
                   }else if (mapJson[i].number == 43){
                     var text1 = '<a href="{% url 'detail-post' 43 %}">'
                   }else if (mapJson[i].number == 44){
                     var text1 = '<a href="{% url 'detail-post' 44 %}">'
                   }else if (mapJson[i].number == 45){
                     var text1 = '<a href="{% url 'detail-post' 45 %}">'
                   }else if (mapJson[i].number == 46){
                     var text1 = '<a href="{% url 'detail-post' 46 %}">'
                   }else if (mapJson[i].number == 47){
                     var text1 = '<a href="{% url 'detail-post' 47 %}">'
                   }else if (mapJson[i].number == 48){
                     var text1 = '<a href="{% url 'detail-post' 48 %}">'
                   }else if (mapJson[i].number == 49){
                     var text1 = '<a href="{% url 'detail-post' 49 %}">'
                   }else if (mapJson[i].number == 50){
                     var text1 = '<a href="{% url 'detail-post' 50 %}">'
                   }else if (mapJson[i].number == 51){
                     var text1 = '<a href="{% url 'detail-post' 51 %}">'
                   }else if (mapJson[i].number == 52){
                     var text1 = '<a href="{% url 'detail-post' 52 %}">'
                   }else if (mapJson[i].number == 53){
                     var text1 = '<a href="{% url 'detail-post' 53 %}">'
                   }else if (mapJson[i].number == 54){
                     var text1 = '<a href="{% url 'detail-post' 54 %}">'
                   }else if (mapJson[i].number == 55){
                     var text1 = '<a href="{% url 'detail-post' 55 %}">'
                   }else if (mapJson[i].number == 56){
                     var text1 = '<a href="{% url 'detail-post' 56 %}">'
                   }else if (mapJson[i].number == 57){
                     var text1 = '<a href="{% url 'detail-post' 57 %}">'
                   }else if (mapJson[i].number == 58){
                     var text1 = '<a href="{% url 'detail-post' 58 %}">'
                   }else if (mapJson[i].number == 59){
                     var text1 = '<a href="{% url 'detail-post' 59 %}">'
                   }else if (mapJson[i].number == 60){
                     var text1 = '<a href="{% url 'detail-post' 60 %}">'
                   }else{
                     var text1 = '<a href="{% url 'detail-post' 61 %}">'
                   }
                 /*ã“ã“ã¾ã§*/

                 var text2 = '</a>'

                 td1.innerHTML = mapJson[i].number+'. ';
                 td2.innerHTML = text1 + mapJson[i].name + text2;
                 td3.innerHTML = mapJson[i].genre;

                 directionsService.route(requestwalking, function (response, status){
                   if(status == 'OK'){
                     var route = response.routes[0];
                     var routeLeg = route.legs[0];
                     var durationText = routeLeg.duration.text;

                     if(route.legs[0].duration.value <= 300){
                       td5.innerHTML = 'ğŸƒâ€â™€ï¸' + durationText;
                       td5.style.color = '#028760';
                     }else if(route.legs[0].duration.value <= 900){
                       td5.innerHTML = 'ğŸƒâ€â™€ï¸' + durationText;
                       td5.style.color = '#FF0000';
                     }else if(route.legs[0].duration.value <= 1800){
                       td5.innerHTML = 'ğŸƒâ€â™€ï¸' + durationText;
                       td5style.color = '#0095d9';
                     }else{
                       td5.innerHTML = 'ğŸƒâ€â™€ï¸' + durationText;
                     }
                   }
                 });

                 directionsService.route(requestdriving, function (response, status){
                   if(status == 'OK'){
                     var route = response.routes[0];
                     var routeLeg = route.legs[0];
                     var durationText = routeLeg.duration.text;

                     td6.innerHTML = 'ğŸš˜' + durationText;
                   }
                 });

                 tr.appendChild(td1);
                 tr.appendChild(td2);
                 tr.appendChild(td3);
                 tr.appendChild(td5);
                 tr.appendChild(td6);
                 tableEle.appendChild(tr);
               })(i);
               count2++;
           }
         }
         }
       }
      }

      function bindInfoWindow(marker, map, infowindow) {
        marker.addListener('click', function() {
          infowindow.open(map, this);
        });
      }

    </script>
    <script src="https://code.jquery.com/jquery.js"></script>
    <script defer src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDiugR_kRyfmu3OjnFbB1QL0qcdB-pfSb0&callback=initMap"
    async defer></script>
{% endblock %}
